window.copyCode=window.copyCode||function(w,v){const p=document.getElementById(v);if(p){const y=p.innerText;navigator.clipboard.writeText(y);const E=w.innerHTML;w.innerHTML='<i class="ti ti-circle-check"></i>&nbsp;\u6210\u529F~',setTimeout(()=>{w.innerHTML=E},3e3)}},(()=>{const w=async()=>{var t;var e=(((t=window.kr)==null?void 0:t.siteRoot)||"/")+"config/main.json";return await(await fetch(e)).json()},v=()=>{let e=!1;const t=()=>{window.requestAnimationFrame(()=>{window.scrollY>200?e||(document.body.classList.add("scroll-down"),e=!0):e&&(document.body.classList.remove("scroll-down"),e=!1)})};document.getElementById("gotop-box").addEventListener("click",o=>(window.scrollTo({top:0,behavior:"smooth"}),!1)),t(),window.addEventListener("scroll",t)},p=()=>{const e=document.getElementById("kratos-menu-wrap").cloneNode(!0);e.setAttribute("id","offcanvas-menu"),e.querySelectorAll("ul").forEach(t=>{t.setAttribute("id",""),t.classList.add("ul-me")}),e.style.height="calc(100% - 60px)",e.style.right="-240px",document.getElementById("kratos-nav-toggle").addEventListener("click",()=>{const t=document.getElementById("kratos-nav-toggle-wrapper");t.classList.contains("toon")?(t.classList.remove("toon"),e.style.right="-240px"):(t.classList.add("toon"),e.style.right="0px")}),document.getElementById("kratos-page").prepend(e),window.addEventListener("resize",t=>{const o=document.getElementById("kratos-nav-toggle-wrapper");window.innerWidth>768&&o.classList.contains("toon")&&(o.classList.remove("toon"),e.style.right="-240px")})},y=()=>{var t;const e=(t=document.querySelectorAll(".xControl"))==null?void 0:t.forEach(o=>{const n=o.getElementsByClassName(".xHeading");n==null||n[0].addEventListener("click",s=>{o.classList.toggle("active")})})},E=e=>{},S=()=>{document.querySelectorAll(".share").forEach(e=>{e.addEventListener("click",()=>{var t;(t=document.getElementsByClassName("share-wrap"))==null||t[0].classList.toggle("show")})})},R=()=>{},I=()=>{document.querySelectorAll("a[class=toc-link]").forEach(e=>{e.addEventListener("click",t=>{window.scrollTo({top:document.getElementById(decodeURI(e.getAttribute(href)).replace("#","")).offsetTop,behavior:"smooth"})})})};let b;const B=e=>{b="\n\n-------------------------\n".concat(e.copyrightNotice,"\n\u4F5C\u8005\uFF1A").concat(document.querySelector("meta[name='author']").getAttribute("content"),"\n\u6765\u6E90\uFF1A").concat(document.title,"\n\u94FE\u63A5\uFF1A").concat(window.location.href,"\n")},N=e=>{e.copyrightNotice&&(document.body.oncopy=t=>{if(b){const o=window.getSelection().toString();o.length>150&&(t.preventDefault(),t.clipboardData&&t.clipboardData.setData("text/plain",o+b))}})};let L="";const M=()=>{L=document.title},D=e=>{if(e.siteLeaveEvent){let t;const o=document.querySelector('[rel="icon"]'),n=o.getAttribute("href");document.addEventListener("visibilitychange",()=>{document.hidden?(document.title=e.leaveTitle,e.leaveLogo&&o.setAttribute("href",e.leaveLogo),clearTimeout(t)):(document.title=e.returnTitle+" "+L,e.leaveLogo&&o.setAttribute("href",n),t=setTimeout(()=>{document.title=L,t=0},2e3))})}},x=(e,t=!0)=>{let o;const n=e/1e3,s=Math.floor(n/60/60/24),d=Math.floor(n/60/60-24*s),g=Math.floor(n/60-24*60*s-60*d),h=Math.floor(n-24*60*60*s-60*60*d-60*g);let u=s.toString(),c=d.toString(),i=g.toString(),l=h.toString();return t?(u&&u.length===1&&(u="0"+u),c&&c.length===1&&(c="0"+c),i&&i.length===1&&(i="0"+i),l&&l.length===1&&(l="0"+l),o=u+"\u5929"+c+"\u5C0F\u65F6"+i+"\u5206"+l+"\u79D2"):s<540?s<60?o=u+"\u5929":o=Math.floor(s/30).toString()+"\u4E2A\u6708":o=Math.floor(s/365).toString()+"\u5E74",o},q=e=>{const t=new Date(e.createTime),o=document.getElementById("span_dt");setInterval(()=>{o.innerText=x(Date.now()-t)},1e3)},H=()=>{document.querySelectorAll("figure.highlight").forEach((t,o)=>{t.getElementsByTagName("table")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr")[0].getElementsByClassName("code")[0].setAttribute("id","code-".concat(o)),t.innerHTML+='<button class="copy" onclick="copyCode(this, \'code-'.concat(o,'\')">\n                <i class="ti ti-copy"></i>&nbsp;\u590D\u5236\n            </button>')})},O=()=>{const e=typeof window<"u",t=e&&!("onscroll"in window)||typeof navigator<"u"&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),o=e&&"IntersectionObserver"in window,n=document.querySelector(".post-comments.lazy-load"),s=()=>{window.loadCommentsEventHandler&&window.cancelIdleCallback(window.loadCommentsEventHandler),!(typeof load_comm>"u"||load_comm===null)&&(window.loadCommentsEventHandler=window.requestIdleCallback(load_comm),load_comm=null)};if(e&&!t&&o&&n!==null){const d=new IntersectionObserver(g=>{g[0].isIntersecting&&(s(),d.disconnect())},{threshold:0});d.observe(n)}else s()},k=e=>{if(e.expire_day){const t=document.getElementById("expire-alert");if(t){const o=t.querySelector("time"),n=new Date(parseInt(o.getAttribute("datetime"))),d=Date.now()-n;d>e.expire_day*24*3600*1e3&&(o.innerText=x(d,!1),t.classList.remove("hidden"))}}},T=(e,t)=>{let o=0;return function(){let n=this,s=arguments;clearTimeout(o),o=setTimeout(function(){e.apply(n,s)},t||0)}},P=()=>{const e=document.getElementById("krw-toc"),t=()=>{const o=e.getElementsByClassName("toc-item"),n=[];try{Array.from(o).forEach(c=>{const i=c.querySelector(".toc-link"),l=decodeURI(i.getAttribute("href"));if(l.substring(0,1)!="#")throw new Error("TOC \u5C0F\u6807\u9898\u94FE\u63A5\u65E0\u6548\uFF0C\u683C\u5F0F\u65E0\u9650");const a=document.getElementById(l.substring(1));if(!a)throw new Error("TOC \u5C0F\u6807\u9898\u94FE\u63A5\u65E0\u6548\uFF0C\u672A\u627E\u5230\u76F8\u5173\u5F15\u7528");a.setAttribute("data-toc-id",n.length),n.push({at:a,el:c})})}catch(c){console.log("\u9519\u8BEF\uFF1A",c.message),Array.from(o).forEach(i=>{i.classList.add("show")});return}let s=-1;const d=c=>{if(s!==c){if(s!==-1){n[s].el.classList.remove("active"),n[s].el.classList.remove("show");let i=n[s].el;for(;!i.classList.contains("toc");)i.classList.contains("toc-item")&&i.classList.remove("show"),i=i.parentNode}if(c!==-1){n[c].el.classList.add("active"),n[c].el.classList.add("show");let i=n[c].el;for(;!i.classList.contains("toc");)i.classList.contains("toc-item")&&i.classList.add("show"),i=i.parentNode}s=c}};if("IntersectionObserver"in window){const c=T((l,a)=>{a===window.scrollY?window.requestAnimationFrame(()=>{d(l)}):c(l,window.scrollY)},100),i=new IntersectionObserver(l=>{let a=null;l.forEach(r=>{const m=Number.parseInt(r.target.getAttribute("data-toc-id"),10);!r.isIntersecting&&r.boundingClientRect.top<=r.rootBounds.top?a=m:r.isIntersecting&&r.boundingClientRect.bottom<r.rootBounds.top+r.rootBounds.height/2&&r.intersectionRatio===1&&(a=m-1)}),a!==null&&c(a,window.scrollY)},{rootMargin:"-62px 0px 0px 0px",threshold:1});n.forEach(l=>{i.observe(l.at)}),window.addEventListener("pjax:before",()=>{i.disconnect(),n.length=0},{once:!0})}else{const c=()=>{n.forEach(r=>{r.h=r.at.getBoundingClientRect().top+window.scrollY-61})};c();const i=()=>{let r;!Number.isInteger(s)||s<0||s>n.length-1?r=0:r=s;const m=window.scrollY;if(m>=n[r].h)if(m>=n[n.length-1].h)r=n.length-1;else for(;m>=n[r+1].h;)r++;else for(;m<n[r].h&&(r--,!(r<0)););return r},l=T(()=>{window.requestAnimationFrame(()=>{d(i())})},100),a=T(()=>{c(),window.requestAnimationFrame(()=>{d(i())})},100);window.addEventListener("resize",a),window.addEventListener("scroll",l),window.addEventListener("pjax:before",()=>{window.removeEventListener("resize",a),window.removeEventListener("scroll",l),n.length=0},{once:!0})}const g=document.getElementsByClassName("toc-progress-bar")[0],h=document.querySelector(".kratos-post-content"),u=()=>{if(h){const c=window.scrollY||document.documentElement.scrollTop,i=h.clientHeight,l=document.documentElement.clientHeight,a=h.offsetTop,r=i>l?i-l:document.documentElement.scrollHeight-l,m=Math.max(0,Math.min((c-a)/r,1)),F=Math.round(m*100);g.style.width=(m*100).toString()+"%",g.setAttribute("aria-valuenow",F)}};window.addEventListener("scroll",()=>{window.requestAnimationFrame(u)}),u()};e&&(e.offsetParent!==null?t():"IntersectionObserver"in window&&new IntersectionObserver(t,{threshold:0,once:!0}).observe(e))},Y=e=>{if(!e.topNavScrollToggle)return;let t=window.innerHeight,o=!1;const n=()=>{window.requestAnimationFrame(()=>{t<window.scrollY?o||(document.body.classList.add("nav-up"),o=!0):t>window.scrollY&&o&&(document.body.classList.remove("nav-up"),o=!1),t=window.scrollY})};window.addEventListener("wheel",n)},C=()=>{P(),M(),H(),I(),O()},A=e=>{B(e),k(e)};window.addEventListener("pjax:complete",()=>{C(),typeof MathJax<"u"&&MathJax.Hub.Typeset()});function f(){document.removeEventListener("DOMContentLoaded",f,!1),window.removeEventListener("load",f,!1),w().then(e=>{N(e),D(e),q(e),E(e),Y(e),A(e),window.addEventListener("pjax:complete",()=>{A(e)})}),v(),p(),y(),S(),I(),C()}document.readyState==="complete"?setTimeout(f):(document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1))})();
